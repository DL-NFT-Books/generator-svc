//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_a "errors";_d "fmt";_f "github.com/unidoc/unipdf/v3/common";_aa "github.com/unidoc/unipdf/v3/core";);func (_acg Page )FindXObjectImages ()([]*Image ,error ){_beg ,_fgf :=_acg .GetResourcesXObject ();if !_fgf {return nil ,nil ;
};var _dg []*Image ;var _baf error ;_agcc :=map[*_aa .PdfObjectStream ]int {};_fc :=map[*_aa .PdfObjectStream ]struct{}{};var _deb int ;for _ ,_fdgb :=range _beg .Keys (){_ecg ,_facd :=_aa .GetStream (_beg .Get (_fdgb ));if !_facd {continue ;};if _ ,_efc :=_agcc [_ecg ];
_efc {continue ;};_ddga ,_efd :=_aa .GetName (_ecg .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_efd ||_ddga .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_dab :=Image {BitsPerComponent :8,Stream :_ecg ,Name :string (_fdgb )};if _dab .Colorspace ,_baf =_bg (_ecg .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));
_baf !=nil {_f .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_baf );continue ;};if _fee ,_bge :=_aa .GetIntVal (_ecg .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));
_bge {_dab .BitsPerComponent =_fee ;};if _bfa ,_begf :=_aa .GetIntVal (_ecg .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));_begf {_dab .Width =_bfa ;};if _gbd ,_cdg :=_aa .GetIntVal (_ecg .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));
_cdg {_dab .Height =_gbd ;};if _fbe ,_fad :=_aa .GetStream (_ecg .Get ("\u0053\u004d\u0061s\u006b"));_fad {_dab .SMask =&ImageSMask {Image :&_dab ,Stream :_fbe };_fc [_fbe ]=struct{}{};};switch _dab .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_dab .ColorComponents =3;
case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_dab .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_dab .ColorComponents =4;default:_dab .ColorComponents =-1;};_agcc [_ecg ]=_deb ;_dg =append (_dg ,&_dab );
_deb ++;};var _bdc []int ;for _ ,_ead :=range _dg {if _ead .SMask !=nil {_feg ,_bef :=_agcc [_ead .SMask .Stream ];if _bef {_bdc =append (_bdc ,_feg );};};};_gbde :=make ([]*Image ,len (_dg )-len (_bdc ));_deb =0;_ffe :for _ccc ,_dgg :=range _dg {for _ ,_fdd :=range _bdc {if _ccc ==_fdd {continue _ffe ;
};};_gbde [_deb ]=_dgg ;_deb ++;};return _dg ,nil ;};func (_ee *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_ea :=_ee .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");if _ea ==nil {return nil ,false ;
};_gc ,_agc :=_aa .GetIndirect (_ea );if !_agc {return nil ,false ;};_ca ,_aeb :=_aa .GetArray (_gc .PdfObject );if !_aeb {return nil ,false ;};return &OutputIntents {_bb :_gc ,_bag :_ca ,_df :_ee ._g },true ;};func (_ggb *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _bc :=_ggb .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_bc !=nil {for _fab ,_fac :=range _ggb ._g .Objects {if _fac ==_bc {if outputIntents ._bb ==_bc {return ;};_ggb ._g .Objects =append (_ggb ._g .Objects [:_fab ],_ggb ._g .Objects [_fab +1:]...);break ;};};};_dd :=outputIntents ._bb ;if _dd ==nil {_dd =_aa .MakeIndirectObject (outputIntents ._bag );
};_ggb .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_dd );_ggb ._g .Objects =append (_ggb ._g .Objects ,_dd );};func (_ba *Catalog )GetPages ()([]Page ,bool ){_da ,_c :=_aa .GetDict (_ba .Object .Get ("\u0050\u0061\u0067e\u0073"));
if !_c {return nil ,false ;};_bf ,_fg :=_aa .GetArray (_da .Get ("\u004b\u0069\u0064\u0073"));if !_fg {return nil ,false ;};_gg :=make ([]Page ,_bf .Len ());for _be ,_ge :=range _bf .Elements (){_dc ,_e :=_aa .GetDict (_ge );if !_e {continue ;};_gg [_be ]=Page {Object :_dc ,_bbg :_be +1,_feb :_ba ._g };
};return _gg ,true ;};func (_de *Catalog )HasMetadata ()bool {_gb :=_de .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");return _gb !=nil ;};func (_cc *Catalog )GetMarkInfo ()(*_aa .PdfObjectDictionary ,bool ){_ag ,_ff :=_aa .GetDict (_cc .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _ag ,_ff ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _aa .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_aa .PdfObjectStream ;};func (_cac Page )GetResources ()(*_aa .PdfObjectDictionary ,bool ){return _aa .GetDict (_cac .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};func (_dee *Catalog )GetMetadata ()(*_aa .PdfObjectStream ,bool ){_eg ,_ae :=_aa .GetStream (_dee .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));return _eg ,_ae ;};type Catalog struct{Object *_aa .PdfObjectDictionary ;_g *Document ;
};func (_dda *Document )FindCatalog ()(*Catalog ,bool ){var _ddg *_aa .PdfObjectDictionary ;for _ ,_ffb :=range _dda .Objects {_fd ,_dfe :=_aa .GetDict (_ffb );if !_dfe {continue ;};if _eef ,_ebc :=_aa .GetName (_fd .Get ("\u0054\u0079\u0070\u0065"));_ebc &&*_eef =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_ddg =_fd ;
break ;};};if _ddg ==nil {return nil ,false ;};return &Catalog {Object :_ddg ,_g :_dda },true ;};func (_bdg *Content )SetData (data []byte )error {_fgdb ,_cce :=_aa .MakeStream (data ,_aa .NewFlateEncoder ());if _cce !=nil {return _cce ;};_fedf ,_fce :=_aa .GetArray (_bdg ._dgb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_fce &&_bdg ._fabc ==0{_bdg ._dgb .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_fgdb );}else {if _cce =_fedf .Set (_bdg ._fabc ,_fgdb );_cce !=nil {return _cce ;};};_bdg ._dgb ._feb .Objects =append (_bdg ._dgb ._feb .Objects ,_fgdb );
return nil ;};func (_eaa Page )FindXObjectForms ()[]*_aa .PdfObjectStream {_dcd ,_dec :=_eaa .GetResourcesXObject ();if !_dec {return nil ;};_eada :=map[*_aa .PdfObjectStream ]struct{}{};var _eaag func (_fge *_aa .PdfObjectDictionary ,_cae map[*_aa .PdfObjectStream ]struct{});
_eaag =func (_dbe *_aa .PdfObjectDictionary ,_edb map[*_aa .PdfObjectStream ]struct{}){for _ ,_bgb :=range _dbe .Keys (){_ecd ,_fgeb :=_aa .GetStream (_dbe .Get (_bgb ));if !_fgeb {continue ;};if _ ,_bac :=_edb [_ecd ];_bac {continue ;};_fddf ,_faa :=_aa .GetName (_ecd .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_faa ||_fddf .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_edb [_ecd ]=struct{}{};_cdc ,_faa :=_aa .GetDict (_ecd .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_faa {continue ;};_fede ,_gcd :=_aa .GetDict (_cdc .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _gcd {_eaag (_fede ,_edb );};};};_eaag (_dcd ,_eada );var _abaf []*_aa .PdfObjectStream ;for _dggb :=range _eada {_abaf =append (_abaf ,_dggb );};return _abaf ;};type OutputIntent struct{Object *_aa .PdfObjectDictionary ;};func (_ab *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_df :_ab ._g }};
func _bg (_dbf _aa .PdfObject )(_aa .PdfObjectName ,error ){var _dbc *_aa .PdfObjectName ;var _ac *_aa .PdfObjectArray ;if _cea ,_fed :=_dbf .(*_aa .PdfIndirectObject );_fed {if _faf ,_bgd :=_cea .PdfObject .(*_aa .PdfObjectArray );_bgd {_ac =_faf ;}else if _ga ,_aef :=_cea .PdfObject .(*_aa .PdfObjectName );
_aef {_dbc =_ga ;};}else if _fdg ,_gcb :=_dbf .(*_aa .PdfObjectArray );_gcb {_ac =_fdg ;}else if _gf ,_ebb :=_dbf .(*_aa .PdfObjectName );_ebb {_dbc =_gf ;};if _dbc !=nil {switch *_dbc {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_dbc ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_dbc ,nil ;};};if _ac !=nil &&_ac .Len ()> 0{if _aacd ,_dea :=_ac .Get (0).(*_aa .PdfObjectName );_dea {switch *_aacd {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _ac .Len ()==1{return *_aacd ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_aacd ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_aacd ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_aacd ,nil ;};};};return "",nil ;};func (_fda *Document )AddStream (stream *_aa .PdfObjectStream ){for _ ,_aba :=range _fda .Objects {if _aba ==stream {return ;
};};_fda .Objects =append (_fda .Objects ,stream );};func (_bbf *OutputIntents )Add (oi _aa .PdfObject )error {_aab ,_gbb :=oi .(*_aa .PdfObjectDictionary );if !_gbb {return _a .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _gcg ,_fe :=_aa .GetStream (_aab .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_fe {_bbf ._df .Objects =append (_bbf ._df .Objects ,_gcg );};_bcg ,_ce :=oi .(*_aa .PdfIndirectObject );if !_ce {_bcg =_aa .MakeIndirectObject (oi );
};if _bbf ._bag ==nil {_bbf ._bag =_aa .MakeArray (_bcg );}else {_bbf ._bag .Append (_bcg );};_bbf ._df .Objects =append (_bbf ._df .Objects ,_bcg );return nil ;};func (_gd *Catalog )SetMarkInfo (mi _aa .PdfObject ){_af :=_aa .MakeIndirectObject (mi );
_gd .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_af );_gd ._g .Objects =append (_gd ._g .Objects ,_af );};type Document struct{ID [2]string ;Version _aa .Version ;Objects []_aa .PdfObject ;Info _aa .PdfObject ;Crypt *_aa .PdfCrypt ;
UseHashBasedID bool ;};func (_gdad Page )GetResourcesXObject ()(*_aa .PdfObjectDictionary ,bool ){_fdc ,_gcgg :=_gdad .GetResources ();if !_gcgg {return nil ,false ;};return _aa .GetDict (_fdc .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_ffa Page )GetContents ()([]Content ,bool ){_aga ,_fgd :=_aa .GetArray (_ffa .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_fgd {_gdb ,_dce :=_aa .GetStream (_ffa .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_dce {return nil ,false ;};return []Content {{Stream :_gdb ,_dgb :_ffa ,_fabc :0}},true ;};_ef :=make ([]Content ,_aga .Len ());for _bdeg ,_gga :=range _aga .Elements (){_ad ,_gcf :=_aa .GetStream (_gga );
if !_gcf {continue ;};_ef [_bdeg ]=Content {Stream :_ad ,_dgb :_ffa ,_fabc :_bdeg };};return _ef ,true ;};func (_bd *Catalog )SetVersion (){_bd .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_aa .MakeName (_d .Sprintf ("\u0025\u0064\u002e%\u0064",_bd ._g .Version .Major ,_bd ._g .Version .Minor )));
};func (_dbce *Page )Number ()int {return _dbce ._bbg };func (_bbc *Document )AddIndirectObject (indirect *_aa .PdfIndirectObject ){for _ ,_cd :=range _bbc .Objects {if _cd ==indirect {return ;};};_bbc .Objects =append (_bbc .Objects ,indirect );};func (_gbc *Document )GetPages ()([]Page ,bool ){_db ,_gba :=_gbc .FindCatalog ();
if !_gba {return nil ,false ;};return _db .GetPages ();};func (_dabe Content )GetData ()([]byte ,error ){_cag ,_fbg :=_aa .NewEncoderFromStream (_dabe .Stream );if _fbg !=nil {return nil ,_fbg ;};_gca ,_fbg :=_cag .DecodeStream (_dabe .Stream );if _fbg !=nil {return nil ,_fbg ;
};return _gca ,nil ;};type Page struct{_bbg int ;Object *_aa .PdfObjectDictionary ;_feb *Document ;};type ImageSMask struct{Image *Image ;Stream *_aa .PdfObjectStream ;};func (_aec *OutputIntents )Get (i int )(OutputIntent ,bool ){if _aec ._bag ==nil {return OutputIntent {},false ;
};if i >=_aec ._bag .Len (){return OutputIntent {},false ;};_ggbf :=_aec ._bag .Get (i );_gda ,_deec :=_aa .GetIndirect (_ggbf );if !_deec {_ec ,_fag :=_aa .GetDict (_ggbf );return OutputIntent {Object :_ec },_fag ;};_eb ,_ega :=_aa .GetDict (_gda .PdfObject );
return OutputIntent {Object :_eb },_ega ;};type Content struct{Stream *_aa .PdfObjectStream ;_fabc int ;_dgb Page ;};func (_aac *OutputIntents )Len ()int {return _aac ._bag .Len ()};type OutputIntents struct{_bag *_aa .PdfObjectArray ;_df *Document ;_bb *_aa .PdfIndirectObject ;
};func (_fb *Catalog )SetMetadata (data []byte )error {_cg ,_fa :=_aa .MakeStream (data ,nil );if _fa !=nil {return _fa ;};_cg .Set ("\u0054\u0079\u0070\u0065",_aa .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_cg .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_aa .MakeName ("\u0058\u004d\u004c"));
_fb .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_cg );_fb ._g .Objects =append (_fb ._g .Objects ,_cg );return nil ;};